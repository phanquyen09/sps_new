<style type="text/css">
<!--
* {
  margin:0;
  padding:0;
}

body {
  color:#333;
  background:#efefef;
}

#main {
  width:610px;
  margin:1em auto 2em;
}

#main p {
  font-size:0.95em;
  line-height:1.4em;
  margin:0 0 1.5em;
}

#preview p {
  font-size:0.95em;
  text-align:center;
  margin:5px 0;
}

#preview .img {
  border:1px solid #000;
  background:#fff;
  padding:0 10px 10px;
  vertical-align:top;
}

#closeBtn {
  text-align:center;
  margin:0;
  padding:2em 0 1em;
  font-size:0.95em;
}

#closeBtn input {
  line-height: 1.3em;
  margin:0 0.5em;
}
-->
</style>
<script language="JavaScript">
<!--
function changefocus() {
  window.focus();
}
window.onload = changefocus;
window.onblur = changefocus;

function overwrite(nfname,tfname)
{
  if ((!!window.opener) && (window.opener.closed == false)){
    if(window.opener.document.IMAGEADD){
      if(window.opener.document.IMAGEADD.OVERWRITE_FILENAME){
        document.getElementById("OVERWRITE_BT").disabled = true;
        if(window.opener.document.IMAGEADD.OVERWRITE_FILENAME.value != nfname){
          alert('上書きに失敗しました。再度追加処理を実行してください。');
          window.close();
          return;
        }
        if(window.opener.document.IMAGEADD.OVERWRITE_TMPNAME.value != tfname){
          alert('上書きに失敗しました。再度追加処理を実行してください。');
          window.close();
          return;
        }
        window.opener.document.IMAGEADD.OVERWRITE.value = 1;
        var tmp = window.opener.document.IMAGEADD.READY_CATEGORY.options[window.opener.document.IMAGEADD.READY_CATEGORY.selectedIndex].value;
        if (tmp != '') window.opener.document.IMAGEADD.Category_Id.value = tmp;
        window.opener.document.IMAGEADD.submit();

        window.close();
      }else{
        alert('上書きに失敗しました。再度追加処理を実行してください。');
        window.close();
      }
    }else{
      alert('画像台帳でもう一度作業してください。');
      window.close();
    }
  }else{
    alert('画像台帳でもう一度作業してください。');
    window.close();
  }
}
//-->
</script>
<div id="main">
  <p><strong>
    既に同じファイル名で画像が登録されています。<br>
    新しい画像で上書きする場合は［上書きする］ボタンをクリックしてください。<br>
    <span style="color:#f00">※サムネイルや小、中、大、特大の画像も新しい画像を元に再生成されます。</span>
  </strong></p>
  <table id="preview">
    <tr>
      <td class="img">
        <p>［登録されている画像]</p><img name="img" border="0" src="<TMPL_VAR NAME=OLD_FILE>" width="<TMPL_VAR NAME=OLD_WIDTH>" height="<TMPL_VAR NAME=OLD_HEIGHT>">
      </td>
      <td>
        <img src="../imgs/img_overwrite.gif" height="38" width="58">
      </td>
      <td class="img">
        <p>［新しい画像]</p><img name="img" border="0" src="<TMPL_VAR NAME=TMP_FILE_BASE64>" width="<TMPL_VAR NAME=NEW_WIDTH>" <TMPL_IF NAME=NEW_HEIGHT>height="<TMPL_VAR NAME=NEW_HEIGHT>"</TMPL_IF>>
      </td>
	</tr>
    </tr>
  </table>

  <div id="closeBtn">
    <input type="button" id="OVERWRITE_BT" value="上書きする" onClick="javascript:overwrite('<TMPL_VAR NAME=NEW_FILE>','<TMPL_VAR NAME=TMP_FILE>');"><input type="button" value="キャンセル" onClick="window.close()">
  </div>

</div>
